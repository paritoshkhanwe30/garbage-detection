# Clone YOLOv5 repository
!git clone https://github.com/ultralytics/yolov5.git

from google.colab import drive
drive.mount('/content/drive')


!unzip '/content/drive/My Drive/dataset.zip' -d /content/yolov5/

!ls /content/yolov5/






import yaml

# Load the data.yaml file
data_path = '/content/yolov5/data.yaml'
with open(data_path) as f:
    data_dict = yaml.safe_load(f)

# Print the current paths
print("Current data.yaml paths:", data_dict)

# Update paths to absolute paths
data_dict['train'] = '/content/yolov5/train/images'
data_dict['val'] = '/content/yolov5/valid/images'
data_dict['test'] = '/content/yolov5/test/images'

# Save the updated data.yaml
with open(data_path, 'w') as f:
    yaml.dump(data_dict, f)

print("Updated data.yaml paths:", data_dict)




!python3 /content/yolov5/train.py --data /content/yolov5/data.yaml --epochs 1 --batch-size 16 --img-size 640




!find /content -name '*.pt'




!ls /content/yolov5/test



!python /content/yolov5/detect.py --weights /content/yolov5/runs/train/exp/weights/best.pt --source /content/yolov5/test --conf 0.25 --img-size 640 --save-txt --save-conf --save-crop



!ls /content/yolov5/test


!python /content/yolov5/detect.py --weights /content/yolov5/runs/train/exp/weights/best.pt --source /content/yolov5/test/images --data /content/yolov5/data.yaml --imgsz 640 --conf-thres 0.25 --iou-thres 0.45 --save-txt --save-conf --save-crop --project /content/yolov5/runs/detect --name exp --exist-ok




from IPython.display import Image, display
display(Image(filename='/content/yolov5/runs/detect/exp/000001_JPG_jpg.rf.3d60dcc577d36500338d022c84651afe.jpg'))



!zip -r detection_results.zip /content/yolov5/runs/detect/exp


!python export.py --weights /content/yolov5/runs/train/exp/weights/best.pt --img 640 --batch 1 --device 0 --include onnx




!python /content/yolov5/detect.py \
    --weights /content/yolov5/runs/train/exp/weights/best.pt \
    --source /content/yolov5/test/images \
    --imgsz 640 \
    --conf-thres 0.25 \
    --iou-thres 0.45 \
    --save-txt \
    --save-conf \
    --save-crop \
    --project /content/yolov5/runs/detect \
    --name test_results \
    --exist-ok











